<div class="col-sm-10 col-sm-offset-1 lists-users">
  <div style="margin: 20px 0">
    <% if flash[:notice] && flash[:notice].include?('deleted') %>
      <div class="alert alert-info fade-in col-sm-4 col-sm-offset-4">
        <%= flash[:notice] %>
      </div>
    <% end %>
    <div class="clearfix"></div>
  </div>
  <div class="page-header">
    <h3>
      <span class="glyphicon glyphicon-user"></span> User Lists
      <a href="/admin/users/new" class="btn btn-primary pull-right btn-add">+</a>
    </h3>
  </div>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Email</th>
          <th>Name</th>
          <th>Status</th>
          <th>Department</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @users.each do |u| %>
          <tr>
            <td><%= u.email %></td>
            <td><%= u.name %></td>
            <td><%= u.status.description %></td>
            <td><%= u.user_department.description %></td>
            <td class="cell-control">
              <a href="/admin/users/<%= u.id %>/edit" title='Edit'>
                <span class="glyphicon glyphicon-pencil"></span>
              </a>&emsp;
              <button type="button" data-id='<%= u.id %>' class='btn-xs btn-link a-delete-user' title='Delete'>
                <span class="glyphicon glyphicon-trash"></span>
              </button>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
<% content_for :header do %>
  <script type="text/javascript">
    $(document).ready(function(){
      $(".a-delete-user").on('click', function(){
        if (confirm('Are you sure you want to delete the user?')) {
          window.location.href = '/admin/users/' + $(this).data('id') + '/delete';
        }
      });
    });
  </script>
<% end %>
