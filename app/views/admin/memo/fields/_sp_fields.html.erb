<% cnt = 0 %>
<table class="table table-bordered category">
  <thead>
    <tr>
      <th>CATEGORY</th>
      <th>AIRCRAFT REGISTRY</th>
      <th>FLIGHT DATE</th>
      <th>FLIGHT NUMBER</th>
      <th>ROUTE</th>
      <th>AIRCRAFT TYPE</th>
      <th>AIRCRAFT CONFIGURATION</th>
      <th>FREQUENCY</th>
      <th>STD</th>
      <th>STA</th>
      <th>NSTD</th>
      <th>NSTA</th>
      <th>REMARKS</th>
    </tr>
  </thead>
  <tbody>
    <% Category.where(id: @category_ids).order(:category).each do |c| %>
      <% @memo.memo_categories.where(category_id: c.id).order(:created_at).decorate.each do |mc| %>
        <tr>
          <td><%= c.category unless cnt > 0 %></td>
          <td><%= mc.ac_registry %></td>
          <td><%= mc.flight_date.try(:strftime, '%m-%d-%y (%a)') %></td>
          <td><%= mc.flight_number %></td>
          <td><%= mc.route %></td>
          <td><%= mc.aircraft_type %></td>
          <td><%= mc.ac_configuration %></td>
          <td><%= (Frequency.where(id: mc.frequencies).collect{|f| f.frequency }).join(', ') unless mc.frequencies.blank? %></td>
          <td><%= mc.std.try(:strftime, '%k%Mz') %></td>
          <td><%= mc.sta.try(:strftime, '%k%Mz') %></td>
          <td><%= mc.nstd.try(:strftime, '%k%Mz') %></td>
          <td><%= mc.nsta.try(:strftime, '%k%Mz') %></td>
          <td><%= mc.remarks %></td>
        </tr>
        <% cnt += 1 %>
      <% end %>
      <% cnt = 0 %>
    <% end %>
  </tbody>
</table>
